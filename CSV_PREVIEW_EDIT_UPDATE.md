# עדכון CSVImportPreviewModal - הוספת יכולת עריכה

## מה השתנה?

הוספתי יכולת **עריכה** לכל שדה במסך התצוגה המקדימה של ייבוא ה-CSV/טקסט, מבלי לשנות את ה-interface של הקומפוננטה.

## הבעיה שנפתרה

משתמשים שפרסרו טקסט חופשי (או ייבאו CSV) ראו שגיאות או אי-דיוקים בפרסור (למשל: שם משפחה חסר, תאריך לא מדויק), אבל **לא יכלו לתקן** אותם ללא ביטול הייבוא והתחלה מחדש.

## הפתרון

### 1. שינויים פנימיים (ללא שבירת ה-API)

הוספתי state מקומי לניהול העריכות:

```typescript
const [editedData, setEditedData] = useState<CSVBirthdayRow[]>([]);
const [editingRow, setEditingRow] = useState<number | null>(null);
```

**חשוב:** הנתונים המקוריים (`data` prop) נשארים ללא שינוי. השינויים נשמרים ב-`editedData` ונשלחים רק בזמן האישור.

### 2. פונקציית עדכון

```typescript
const updateRowField = (rowIndex: number, field: keyof CSVBirthdayRow, value: any) => {
  const newData = [...editedData];
  newData[rowIndex] = { ...newData[rowIndex], [field]: value };
  setEditedData(newData);
};
```

### 3. כפתור עריכה/שמור

בכל שורה יש כפתור **"ערוך"** שמחליף את התצוגה הסטטית לשדות עריכה:

- **מצב רגיל:** טקסט סטטי + כפתור כחול "ערוך"
- **מצב עריכה:** שדות input + כפתור ירוק "שמור"

## שדות שניתן לערוך

✅ **שם פרטי** - `<input type="text">`  
✅ **שם משפחה** - `<input type="text">`  
✅ **תאריך לידה** - `<input type="date">`  
✅ **מגדר** - `<select>` (זכר/נקבה/אחר)  
✅ **אחרי שקיעה** - `<select>` (כן/לא)  
✅ **הערות** - `<textarea>` (מוצג רק במצב עריכה)  
✅ **קבוצה** - הייתה עבירה מלכתחילה

## עיצוב

- שדות עריכה מסומנים עם **border כחול** (`border-blue-300`)
- כפתור "ערוך" - כחול
- כפתור "שמור" - ירוק
- כל השדות responsive ומתאימים למובייל

## תאימות לאחור

✅ **ה-interface לא השתנה** - `CSVImportPreviewModalProps` זהה  
✅ **ה-API לא השתנה** - `onConfirm()` מקבל אותם טיפוסים  
✅ **רכיבים אחרים** - לא מושפעים כלל  
✅ **זרימת הייבוא** - נשארה זהה  

## איך זה עובד?

### זרימת משתמש:

1. משתמש מדביק טקסט/מייבא CSV
2. מסך התצוגה המקדימה נפתח
3. משתמש רואה שגיאה/אי-דיוק בשורה
4. **לוחץ "ערוך"** 🆕
5. משנה את השדות הרלוונטיים
6. **לוחץ "שמור"** 🆕
7. ממשיך לאישור הייבוא

### זרימה טכנית:

```
Original Data (prop)
    ↓
editedData (state) ← עדכונים מהמשתמש
    ↓
handleConfirm() → שולח editedData
    ↓
onConfirm() (קיים)
    ↓
Database ✅
```

## דוגמה

### לפני:
```
❌ שם: "אפרת בן" | שם משפחה: "ברוך"
   (הפרסור טעה - "בן" לא שם משפחה)
   
   → אין דרך לתקן → צריך להתחיל מחדש
```

### אחרי:
```
✅ שם: "אפרת בן" | שם משפחה: "ברוך"
   (הפרסור טעה - "בן" לא שם משפחה)
   
   → לוחץ "ערוך"
   → משנה ל: "אפרת" | "בן ברוך"
   → לוחץ "שמור"
   → ממשיך לייבוא ✅
```

## זהירות ושמירת תאימות

העדכון בוצע בזהירות רבה:

1. **לא שונה ה-interface** - הקומפוננטה עדיין מקבלת אותם props
2. **לא שונה ה-output** - `onConfirm()` עדיין מקבל `CSVBirthdayRow[]`
3. **state מקומי בלבד** - כל השינויים פנימיים לקומפוננטה
4. **backward compatible** - קוד ישן ממשיך לעבוד בדיוק כמו קודם

## קבצים ששונו

- ✅ `v3cv2/src/components/modals/CSVImportPreviewModal.tsx` (רק שינויים פנימיים)

## תוצאה

משתמשים יכולים עכשיו:
- ✅ לראות את התוצאות של הפרסור
- ✅ לערוך כל שדה שנפרסר לא נכון
- ✅ לתקן שגיאות ללא התחלה מחדש
- ✅ להוסיף הערות
- ✅ לשנות מגדר/שקיעה בקלות

**הכל עובד בצורה מושלמת ללא שבירת קוד קיים!** 🎉

